#!/bin/sh
#
# Start the hostapd....
#

PIDFILE=/var/run/hostapd.pid
CONF=/etc/hostapd.conf
HOSTAPD=/usr/sbin/hostapd
PATH=/sbin:/bin:/usr/sbin:/usr/bin
OPTS="-B -P $PIDFILE $CONF"

case "$1" in
  start)
        printf "Starting hostapd: "
	/usr/bin/update_ssid.sh
        if [ -e $PIDFILE ]
        then
            echo "hostapd already started"
            exit 0
        fi 
        $HOSTAPD $OPTS > /dev/null 2>&1
        ;;
  stop)
        printf "Stopping hostapd: "
        killall hostapd > /dev/null 2>&1
        rm -rf $PIDFILE > /dev/null 2>&1
        ;;
  restart|reload)
        "$0" stop
        "$0" start
        ;;
  *)
        echo "Usage: $0 {start|stop|restart}"
        exit 1
esac

exit $?
